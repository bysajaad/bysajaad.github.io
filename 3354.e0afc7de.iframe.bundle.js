"use strict";(self.webpackChunkdigikala_now_react=self.webpackChunkdigikala_now_react||[]).push([[3354],{"./node_modules/@storybook/addon-styling/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[13].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[13].use[2]!./node_modules/resolve-url-loader/index.js!./node_modules/@storybook/addon-styling/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[13].use[4]!./src/components/profile/ProfileAddAddressDetailsSection/ProfileAddressDetailsInfo.module.scss":function(module,__webpack_exports__,__webpack_require__){var _node_modules_storybook_addon_styling_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@storybook/addon-styling/node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_storybook_addon_styling_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_storybook_addon_styling_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_storybook_addon_styling_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@storybook/addon-styling/node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_storybook_addon_styling_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_storybook_addon_styling_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".UfJylvbIVB9tWqqPywp2{height:100px}.g65owvSnDa09hQWrKRD0{height:100px;background:linear-gradient(180deg, #ffffff 0%, rgba(255, 255, 255, 0.0001) 100%);-webkit-transform:rotate(-180deg);transform:rotate(-180deg)}.dark .g65owvSnDa09hQWrKRD0{background:none}","",{version:3,sources:["webpack://./src/components/profile/ProfileAddAddressDetailsSection/ProfileAddressDetailsInfo.module.scss"],names:[],mappings:"AACE,sBACE,YAAA,CAEF,sBACE,YAAA,CACA,gFAAA,CACA,iCAAA,CAAA,yBAAA,CACA,4BACE,eAAA",sourcesContent:[".ProfileAddAddressDetailsSection {\n  &__fullAddressInput {\n    height: 100px;\n  }\n  &__mapFadeBackground {\n    height: 100px;\n    background: linear-gradient(180deg, #ffffff 0%, rgba(255, 255, 255, 0.0001) 100%);\n    transform: rotate(-180deg);\n    :global(.dark) & {\n      background: none;\n    }\n  }\n}\n"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={ProfileAddAddressDetailsSection__fullAddressInput:"UfJylvbIVB9tWqqPywp2",ProfileAddAddressDetailsSection__mapFadeBackground:"g65owvSnDa09hQWrKRD0"},__webpack_exports__.Z=___CSS_LOADER_EXPORT___},"./src/components/profile/ProfileAddAddressModal/index.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:function(){return profile_ProfileAddAddressModal}});var defineProperty=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),react=__webpack_require__("./node_modules/react/index.js"),slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),utils=__webpack_require__("./src/utils/index.ts"),cubes=__webpack_require__("./src/components/cubes/index.ts"),injectStylesIntoStyleTag=__webpack_require__("./node_modules/@storybook/addon-styling/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),styleDomAPI=__webpack_require__("./node_modules/@storybook/addon-styling/node_modules/style-loader/dist/runtime/styleDomAPI.js"),styleDomAPI_default=__webpack_require__.n(styleDomAPI),insertBySelector=__webpack_require__("./node_modules/@storybook/addon-styling/node_modules/style-loader/dist/runtime/insertBySelector.js"),insertBySelector_default=__webpack_require__.n(insertBySelector),setAttributesWithoutAttributes=__webpack_require__("./node_modules/@storybook/addon-styling/node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),setAttributesWithoutAttributes_default=__webpack_require__.n(setAttributesWithoutAttributes),insertStyleElement=__webpack_require__("./node_modules/@storybook/addon-styling/node_modules/style-loader/dist/runtime/insertStyleElement.js"),insertStyleElement_default=__webpack_require__.n(insertStyleElement),styleTagTransform=__webpack_require__("./node_modules/@storybook/addon-styling/node_modules/style-loader/dist/runtime/styleTagTransform.js"),styleTagTransform_default=__webpack_require__.n(styleTagTransform),ProfileAddressDetailsInfo_module=__webpack_require__("./node_modules/@storybook/addon-styling/node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[13].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[13].use[2]!./node_modules/resolve-url-loader/index.js!./node_modules/@storybook/addon-styling/node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[13].use[4]!./src/components/profile/ProfileAddAddressDetailsSection/ProfileAddressDetailsInfo.module.scss"),options={};options.styleTagTransform=styleTagTransform_default(),options.setAttributes=setAttributesWithoutAttributes_default(),options.insert=insertBySelector_default().bind(null,"head"),options.domAPI=styleDomAPI_default(),options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(ProfileAddressDetailsInfo_module.Z,options);var ProfileAddAddressDetailsSection_ProfileAddressDetailsInfo_module=ProfileAddressDetailsInfo_module.Z&&ProfileAddressDetailsInfo_module.Z.locals?ProfileAddressDetailsInfo_module.Z.locals:void 0,constants_errors=__webpack_require__("./src/constants/errors.ts"),index_esm=__webpack_require__("./node_modules/react-hook-form/dist/index.esm.js"),shared=__webpack_require__("./src/components/shared/index.ts"),TextFieldVariants=__webpack_require__("./src/components/cubes/TextField/TextFieldVariants.ts"),addressNamesIcons=__webpack_require__("./src/constants/addressNamesIcons.ts"),__jsx=react.createElement;function ProfileAddAddressDetailsSection(_ref){var _errors$address,_errors$buildingNumbe,className=_ref.className,approximateAddress=_ref.approximateAddress,showMap=_ref.showMap,latitude=_ref.latitude,longitude=_ref.longitude,fullAddressClassName=(0,utils.dh)("bg-100 rounded-sm",[ProfileAddAddressDetailsSection_ProfileAddressDetailsInfo_module.ProfileAddAddressDetailsSection__fullAddressInput]),_useFormContext=(0,index_esm.Gc)(),register=_useFormContext.register,errors=_useFormContext.errors,watch=_useFormContext.watch,setValue=_useFormContext.setValue,name=watch("name"),_useState=(0,react.useState)(!1),isCustomNameMode=_useState[0],setIsCustomNameMode=_useState[1];(0,react.useEffect)((function(){!isCustomNameMode&&name&&((0,utils.l$)(addressNamesIcons.hV,name)?setIsCustomNameMode(!1):setIsCustomNameMode(!0))}),[name,isCustomNameMode]),(0,react.useEffect)((function(){approximateAddress&&setValue("address",approximateAddress)}),[approximateAddress]);var nameOnChange=function nameOnChange(value){!function deActiveToCustomNameMode(){setIsCustomNameMode(!1)}(),setValue("name",value)};return __jsx("div",{className:className},(0,utils.hj)(latitude)&&(0,utils.hj)(longitude)&&__jsx("div",{className:"relative"},__jsx(shared.D5,{latitude:latitude,longitude:longitude,height:134,disableCurrentLocation:!0,dragging:!1,boxZoom:!1,scrollWheelZoom:!1,touchZoom:!1,doubleClickZoom:!1,className:"z-0"}),__jsx("div",{className:(0,utils.dh)("absolute bottom-0 left-0 w-full",ProfileAddAddressDetailsSection_ProfileAddressDetailsInfo_module.ProfileAddAddressDetailsSection__mapFadeBackground)})),__jsx("div",{className:"px-5 pb-4"},__jsx("div",{className:"flex items-center justify-between pt-4 pb-3 border-b border-b-100"},__jsx("span",{className:"text-body2-strong color-800 break-words"},approximateAddress),__jsx(cubes.ee,{label:"تغییر مکان روی نقشه",hasArrowIcon:!1,leftIcon:"undo",className:"shrink-0 mr-2",onClick:showMap,color:"primary",iconColor:"primary"})),__jsx("div",{className:"mt-3"},__jsx(cubes.nv,{shape:"withoutBorder",name:"address",containerClassName:fullAddressClassName,label:"آدرس کامل",labelClassName:"text-body-1 color-700 pr-3",fullWidth:!0,childrenClassName:"h-full py-2 text-subtitle color-800",required:!0,ref:register({required:{value:!0,message:constants_errors.Z.required}}),error:null==errors||null===(_errors$address=errors.address)||void 0===_errors$address?void 0:_errors$address.message,inputClassName:"bg-100",variant:TextFieldVariants.i.TEXTAREA})),__jsx("div",{className:"mt-3"},__jsx(cubes.nv,{shape:"withoutBorder",containerClassName:"bg-100 rounded-sm",name:"buildingNumber",label:"پلاک",labelClassName:"text-body-1 color-700 pr-3",fullWidth:!0,required:!0,childrenClassName:"text-subtitle color-800",ref:register({required:{value:!0,message:constants_errors.Z.required}}),error:null==errors||null===(_errors$buildingNumbe=errors.buildingNumber)||void 0===_errors$buildingNumbe?void 0:_errors$buildingNumbe.message,inputClassName:(0,utils.dh)(ProfileAddAddressDetailsSection_ProfileAddressDetailsInfo_module["ProfileAddAddressDetailsSection--autofill"])})),__jsx("div",{className:"mt-3 border-b border-b-100 pb-4"},__jsx(cubes.nv,{shape:"withoutBorder",childrenClassName:"text-subtitle color-800",containerClassName:"bg-100 rounded-sm",name:"buildingUnit",label:"واحد",labelClassName:"text-body-1 color-700 pr-3",fullWidth:!0,ref:register(),inputClassName:(0,utils.dh)(ProfileAddAddressDetailsSection_ProfileAddressDetailsInfo_module["ProfileAddAddressDetailsSection--autofill"])})),__jsx(cubes.Dx,{label:"انتخاب عنوان آدرس",titleClassName:"text-subtitle-strong color-900 pt-1"}),__jsx("div",{className:"flex items-center flex-wrap"},Object.entries(addressNamesIcons.hV).map((function(_ref2){var _ref3=(0,slicedToArray.Z)(_ref2,2),title=_ref3[0],icon=_ref3[1];return __jsx(cubes.Af,{onClick:nameOnChange.bind(null,title),isActive:title===name&&!isCustomNameMode,key:title,className:"ml-2 lg:pl-3",label:title,icon:null==icon?void 0:icon.defaultIcon,activeColor:"success"})})),__jsx(cubes.Af,{label:"+ عنوان دلخواه",onClick:function toggleToCustomNameMode(){setValue("name",""),setIsCustomNameMode(!0)},isActive:isCustomNameMode,activeColor:"success",className:"lg:pl-3"})),isCustomNameMode&&__jsx(cubes.nv,{shape:"withoutBorder",placeholder:"عنوان دلخواه شما",inputProps:{onChange:function customNameOnChange(e){setValue("name",e.target.value)}},className:"mt-2 w-full",containerClassName:"bg-100",value:name})))}ProfileAddAddressDetailsSection.displayName="ProfileAddAddressDetailsSection",ProfileAddAddressDetailsSection.__docgenInfo={description:"",methods:[],displayName:"ProfileAddAddressDetailsSection",props:{className:{required:!1,tsType:{name:"string"},description:""},showMap:{required:!0,tsType:{name:"SimpleFunction"},description:""},approximateAddress:{required:!1,tsType:{name:"string"},description:""},latitude:{required:!1,tsType:{name:"number"},description:""},longitude:{required:!1,tsType:{name:"number"},description:""}}};var profile_ProfileAddAddressDetailsSection=ProfileAddAddressDetailsSection;try{ProfileAddAddressDetailsSection.displayName="ProfileAddAddressDetailsSection",ProfileAddAddressDetailsSection.__docgenInfo={description:"",displayName:"ProfileAddAddressDetailsSection",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},showMap:{defaultValue:null,description:"",name:"showMap",required:!0,type:{name:"SimpleFunction"}},approximateAddress:{defaultValue:null,description:"",name:"approximateAddress",required:!1,type:{name:"string"}},latitude:{defaultValue:null,description:"",name:"latitude",required:!1,type:{name:"number"}},longitude:{defaultValue:null,description:"",name:"longitude",required:!1,type:{name:"number"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/profile/ProfileAddAddressDetailsSection/index.tsx#ProfileAddAddressDetailsSection"]={docgenInfo:ProfileAddAddressDetailsSection.__docgenInfo,name:"ProfileAddAddressDetailsSection",path:"src/components/profile/ProfileAddAddressDetailsSection/index.tsx#ProfileAddAddressDetailsSection"})}catch(__react_docgen_typescript_loader_error){}var ModalLayout=__webpack_require__("./src/components/container/layout/ModalLayout/index.tsx"),hooks=__webpack_require__("./src/hooks/index.ts"),useAddress=__webpack_require__("./src/hooks/useAddress.ts"),useEventTypes=__webpack_require__("./src/constants/useEventTypes.ts"),LocationModalMapComponent=__webpack_require__("./src/components/shared/LocationModal/LocationModalMapComponent.tsx"),configureStore=__webpack_require__("./src/store/configureStore.tsx"),alertSlice=__webpack_require__("./src/store/alert/alertSlice.ts"),PageContext=__webpack_require__("./src/components/container/PageContainer/PageContext.tsx"),GATrackingIds=__webpack_require__("./src/constants/GATrackingIds.ts"),ProfileAddAddressModal_jsx=react.createElement;function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){(0,defineProperty.Z)(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function ProfileAddAddressModal(_ref){var className=_ref.className,_useState=(0,react.useState)({isOpen:!1}),data=_useState[0],setData=_useState[1],_useState2=(0,react.useState)({}),location=_useState2[0],setLocation=_useState2[1],_useState3=(0,react.useState)(!0),isShowMap=_useState3[0],setIsShowMap=_useState3[1],_useState4=(0,react.useState)({}),addressReverseResult=_useState4[0],setSearchAddressReverseResult=_useState4[1],dispatch=(0,configureStore.TL)(),pageContextData=(0,react.useContext)(PageContext.z).pageContextData,isOpen=data.isOpen,initialLatitude=data.initialLatitude,initialLongitude=data.initialLongitude,initialAddressId=data.initialAddressId,initialBuildingNumber=data.initialBuildingNumber,initialBuildingUnit=data.initialBuildingUnit,initialName=data.initialName,initialAddress=data.initialAddress,shouldOpenMapOnLoad=data.shouldOpenMapOnLoad,canEditUnsavedDefaultAddress=data.canEditUnsavedDefaultAddress,showMap=function showMap(){return setIsShowMap(!0)},hideMap=function hideMap(){return setIsShowMap(!1)};(0,hooks.xd)([{event:useEventTypes.QG,handler:function onOpen(value){null!=value&&value.initialAddressId&&(null==value||!value.shouldOpenMapOnLoad)||null!=value&&value.canEditUnsavedDefaultAddress?hideMap():showMap(),setData(_objectSpread(_objectSpread({},value),{},{isOpen:!0}))}},{event:useEventTypes.UM,handler:function handler(){return function onClose(){var isForceClose=arguments.length>0&&void 0!==arguments[0]&&arguments[0];pageContextData.isForcedToAddAddress&&!isForceClose||setData({isOpen:!1})}(!0)}}]);var _useAddress=(0,useAddress.Z)(),addAddress=_useAddress.addAddress,editAddress=_useAddress.editAddress,pendingCreateAddress=_useAddress.pendingCreateAddress,pendingEditAddress=_useAddress.pendingEditAddress,closeAddAddressModal=_useAddress.closeAddAddressModal,formMethods=(0,index_esm.cI)({shouldUnregister:!1}),handleSubmit=formMethods.handleSubmit,register=formMethods.register,setValue=formMethods.setValue,reset=formMethods.reset,componentClassName=(0,utils.dh)("p-0 h-full",className);(0,react.useEffect)((function(){!isOpen||initialAddressId||shouldOpenMapOnLoad||canEditUnsavedDefaultAddress||showMap(),isOpen||reset()}),[isOpen,initialAddressId,shouldOpenMapOnLoad,canEditUnsavedDefaultAddress]),(0,react.useEffect)((function(){setLocation({latitude:initialLatitude,longitude:initialLongitude})}),[initialLatitude,initialLongitude]),(0,react.useEffect)((function(){(initialAddressId&&!isShowMap||canEditUnsavedDefaultAddress)&&(setValue("name",initialName),setValue("buildingNumber",initialBuildingNumber),setValue("buildingUnit",initialBuildingUnit),setValue("address",initialAddress))}),[initialAddressId,initialBuildingNumber,initialBuildingUnit,initialName,initialAddress,isShowMap]),(0,react.useEffect)((function(){register({name:"name",buildingNumber:"buildingNumber",buildingUnit:"buildingUnit",address:"address"})}),[register]);var successAlert=function successAlert(text){dispatch((0,alertSlice.yF)({text:text,closeText:""}))},saveAddress=function saveAddress(formData){var latitude=location.latitude,longitude=location.longitude,name=formData.name,address=formData.address,buildingNumber=formData.buildingNumber,buildingUnit=formData.buildingUnit;initialAddressId?editAddress({addressId:initialAddressId||void 0,address:address,latitude:latitude,longitude:longitude,name:name,buildingNumber:buildingNumber,buildingUnit:buildingUnit}).then((function(response){var _data$onFinish;closeAddAddressModal(),(null==response?void 0:response.addressId)&&(null==data||null===(_data$onFinish=data.onFinish)||void 0===_data$onFinish||_data$onFinish.call(data,null==response?void 0:response.addressId)),successAlert("آدرس ویرایش شد!")})):addAddress({address:address,latitude:latitude,longitude:longitude,name:name,buildingNumber:buildingNumber,buildingUnit:buildingUnit}).then((function(response){var _data$onFinish2;closeAddAddressModal(),(null==response?void 0:response.addressId)&&(null==data||null===(_data$onFinish2=data.onFinish)||void 0===_data$onFinish2||_data$onFinish2.call(data,null==response?void 0:response.addressId)),successAlert("آدرس اضافه شد!")}))},footer=ProfileAddAddressModal_jsx("div",{className:"py-3 px-5 flex items-center justify-center shadow-1-top"},ProfileAddAddressModal_jsx(cubes.zx,{dataTrackingId:GATrackingIds.N.submitAddress,type:"submit",className:"grow",shape:"filled",color:"primary",size:"large",loading:pendingEditAddress||pendingCreateAddress,onClick:handleSubmit(saveAddress)},"ثبت")),header=ProfileAddAddressModal_jsx(cubes.Dx,{className:"mt-2 px-5",rightIcon:"arrowRight",rightIconOnClick:initialAddressId?closeAddAddressModal:showMap,label:"جزئیات آدرس"});return ProfileAddAddressModal_jsx(cubes.u_,{className:componentClassName,open:isOpen,onClose:function onClose(){return closeAddAddressModal(!0)},isFullScreen:!0,shouldCloseOnOverlayClick:!pageContextData.isForcedToAddAddress,shouldCloseOnEsc:!pageContextData.isForcedToAddAddress},isShowMap?ProfileAddAddressModal_jsx(LocationModalMapComponent.Z,{onClose:function onClose(){return closeAddAddressModal(!0)},onConfirm:function confirmLocationOnClick(data){setSearchAddressReverseResult(data),setLocation({latitude:null==data?void 0:data.addressLatitude,longitude:null==data?void 0:data.addressLongitude}),hideMap()},initialLatitude:location.latitude,initialLongitude:location.longitude}):ProfileAddAddressModal_jsx(ModalLayout.Z,{header:header,footer:footer,hasHeaderBottomShadow:!0,isFooterFixed:!0},ProfileAddAddressModal_jsx(index_esm.RV,formMethods,ProfileAddAddressModal_jsx("form",{onSubmit:handleSubmit(saveAddress),className:"h-full"},ProfileAddAddressModal_jsx(profile_ProfileAddAddressDetailsSection,{showMap:function changeLocationOnMap(){showMap(),canEditUnsavedDefaultAddress&&setData((function(prevState){return _objectSpread(_objectSpread({},prevState),{},{canEditUnsavedDefaultAddress:!1})}))},approximateAddress:null==addressReverseResult?void 0:addressReverseResult.addressAddress,latitude:location.latitude,longitude:location.longitude})))))}ProfileAddAddressModal.displayName="ProfileAddAddressModal",ProfileAddAddressModal.__docgenInfo={description:"",methods:[],displayName:"ProfileAddAddressModal",props:{className:{required:!1,tsType:{name:"string"},description:""}}};var profile_ProfileAddAddressModal=ProfileAddAddressModal;try{ProfileAddAddressModal.displayName="ProfileAddAddressModal",ProfileAddAddressModal.__docgenInfo={description:"",displayName:"ProfileAddAddressModal",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/profile/ProfileAddAddressModal/index.tsx#ProfileAddAddressModal"]={docgenInfo:ProfileAddAddressModal.__docgenInfo,name:"ProfileAddAddressModal",path:"src/components/profile/ProfileAddAddressModal/index.tsx#ProfileAddAddressModal"})}catch(__react_docgen_typescript_loader_error){}}}]);